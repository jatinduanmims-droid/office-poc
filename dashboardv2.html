<div class="dashboard-v2">

  <!-- KPI STRIP -->
  <section class="kpi-strip">
    <div class="kpi"> <span>120</span><small>Total Controls</small></div>
    <div class="kpi success"> <span>107</span><small>Successful</small></div>
    <div class="kpi danger"> <span>24</span><small>Unsuccessful</small></div>
    <div class="kpi success"> <span>82%</span><small>SLA Met</small></div>
    <div class="kpi danger"> <span>18%</span><small>SLA Breach</small></div>
  </section>

  <!-- PERFORMANCE + FAILED -->
  <section class="grid-2">
    <mat-card>
      <h3>Controls Performance</h3>

      <div class="bar">
        <label>Trade Controls</label>
        <progress max="100" [value]="tradeSuccessCount"></progress>
      </div>

      <div class="bar">
        <label>Loan Controls</label>
        <progress max="100" [value]="loanSuccessCount"></progress>
      </div>

      <div class="bar">
        <label>Supply Chain Controls</label>
        <progress max="100" [value]="supplySuccessCount"></progress>
      </div>
    </mat-card>

    <mat-card class="failed">
      <h3>Failed Controls (Today)</h3>
      <ul>
        <li *ngFor="let fc of failedControlsToday">{{ fc }}</li>
      </ul>
    </mat-card>
  </section>

  <!-- SLA TREND -->
  <mat-card class="sla-card">
    <div class="sla-header">
      <h3>SLA Trend</h3>

      <mat-form-field appearance="outline">
        <input matInput
               [formControl]="searchControl"
               [matAutocomplete]="auto"
               placeholder="Select control">
      </mat-form-field>

      <mat-autocomplete #auto="matAutocomplete"
                        (optionSelected)="onSelectControl($event.option.value)">
        <mat-option *ngFor="let c of filteredControls$ | async" [value]="c">
          {{ c.name }}
        </mat-option>
      </mat-autocomplete>
    </div>

    <div class="chart">
      <canvas baseChart
              [data]="lineChartData"
              [options]="lineChartOptions"
              type="line">
      </canvas>
    </div>
  </mat-card>

</div>