<div class="dashboard">

  <!-- ================= KPI HEADER ================= -->
  <div class="kpi-strip">
    <div class="kpi"> <div>{{ animated.total }}</div><span>Total Controls</span></div>
    <div class="kpi success"> <div>{{ animated.success }}</div><span>Successful</span></div>
    <div class="kpi danger"> <div>{{ animated.failure }}</div><span>Unsuccessful</span></div>
    <div class="kpi success"> <div>{{ animated.slaMet }}%</div><span>SLA Met</span></div>
    <div class="kpi danger"> <div>{{ animated.slaBreach }}%</div><span>SLA Breach</span></div>
  </div>

  <!-- ================= MID GRID ================= -->
  <div class="mid-grid">

    <!-- Controls Performance -->
    <div class="card">
      <div class="card-header">‚≠ê Controls Performance</div>

      <div *ngFor="let d of domains"
           class="domain-row"
           [class.active]="selectedDomain.key === d.key"
           (click)="selectDomain(d)">

        <div class="label">{{ d.label }}</div>

        <div class="bar">
          <div class="bar-success"
               [style.width.%]="(d.success / d.total) * 100"></div>
          <div class="bar-failure"
               [style.width.%]="(d.failure / d.total) * 100"></div>
        </div>

        <div class="count">{{ d.success }} / {{ d.failure }}</div>
      </div>
    </div>

    <!-- Failed Controls -->
    <div class="card failed">
      <div class="card-header">
        Failed Controls (Today)
        <span class="badge">{{ failedControlsToday.length }}</span>
      </div>

      <div class="failed-body">
        <ul>
          <li *ngFor="let f of failedControlsToday">‚ö† {{ f }}</li>
        </ul>
      </div>
    </div>

  </div>

  <!-- ================= SLA TREND ================= -->
  <div class="card sla-card">
    <div class="card-header with-select">
      <span>üìà SLA Trend ‚Äì {{ selectedControl.name }}</span>

      <select>
        <option *ngFor="let c of controls">{{ c.name }}</option>
      </select>
    </div>

    <div class="sla-chart-wrapper">
      <canvas baseChart
              [data]="lineChartData"
              [options]="lineChartOptions"
              [type]="'line'">
      </canvas>
    </div>
  </div>

</div>