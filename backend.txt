Perfect üëç
Below is the complete, clean, small, and precise prompt list ‚Äî backend first, frontend next, in the exact order you should run them in Roo Code.

No fluff. No overlap. No ambiguity.
Each prompt does one job only.

‚∏ª

üîß BACKEND PROMPTS (RUN FIRST)

‚∏ª

üîπ BACKEND PROMPT 0 ‚Äî Backend Awareness

Analyze the FastAPI backend and report:
- Where routes are defined
- Where SQL / DB access happens
- How Oracle VPD is enforced
- Existing helpers or repositories
Do not modify any code.


‚∏ª

üîπ BACKEND PROMPT 1 ‚Äî KPI Endpoint

Add a new endpoint:

GET /dashboard/kpis

Requirements:
- Do not modify existing endpoints
- Compute KPIs server-side using SQL aggregation
- Support optional date range filters
- Include comparison vs yesterday and last week

Return:
- Route code
- SQL queries
- Pydantic response schema


‚∏ª

üîπ BACKEND PROMPT 2 ‚Äî Trends Endpoint

Add a new endpoint:

GET /dashboard/trends

Requirements:
- Return aggregated time-series data
- Support groupBy: daily | weekly | monthly
- Support rangeDays (default 30, max 365)
- Do not return raw rows

Return:
- Route code
- SQL aggregation logic
- Response schema


‚∏ª

üîπ BACKEND PROMPT 3 ‚Äî Server-Side Table Endpoint

Add a new endpoint:

GET /dashboard/table

Requirements:
- Server-side pagination
- Server-side sorting
- Server-side filtering
- Never return full dataset
- Reuse existing Oracle views & VPD

Return:
- Route code
- SQL queries
- Pagination logic


‚∏ª

üîπ BACKEND PROMPT 4 ‚Äî Performance Review

Review dashboard-related queries and:
- Recommend missing indexes
- Identify slow queries
- Suggest safe caching
Ensure VPD is not affected.
Return recommendations only.


‚∏ª

üîπ BACKEND PROMPT 5 ‚Äî Backend Validation

Validate new dashboard endpoints by:
- Comparing KPI numbers vs legacy UI
- Checking for breaking changes
- Confirming performance targets

Return a validation checklist.


‚∏ª

üé® FRONTEND PROMPTS (RUN AFTER BACKEND)

‚∏ª

üîπ FRONTEND PROMPT 1 ‚Äî Repo & Stack Awareness

Analyze the Angular setup and report:
- Angular version
- Angular Material usage
- Chart libraries installed
- API base URL configuration
Ignore UI components.


‚∏ª

üîπ FRONTEND PROMPT 2 ‚Äî New Frontend Shell

Create a new Angular app shell at src/app-v2.

Rules:
- Do not touch src/app
- Copy only core/, environments/, assets/

Generate:
- app-v2.module.ts
- app-v2-routing.module.ts

Routing:
'' ‚Üí dashboard (lazy-loaded)


‚∏ª

üîπ FRONTEND PROMPT 3 ‚Äî Root Routing Integration

Add a new lazy-loaded route:

/dashboard-v2 ‚Üí AppV2Module

Do not modify existing routes.
Return routing changes only.


‚∏ª

üîπ FRONTEND PROMPT 4 ‚Äî Dashboard Module

Create a clean dashboard module under:

src/app-v2/dashboard/

Generate:
- dashboard.module.ts
- dashboard-routing.module.ts
- dashboard-page.component.ts

Routing path: ''
No UI logic yet.


‚∏ª

üîπ FRONTEND PROMPT 5 ‚Äî API Models

Create TypeScript interfaces for:
- /dashboard/kpis
- /dashboard/trends
- /dashboard/table

Include query params and response types.
No UI code.


‚∏ª

üîπ FRONTEND PROMPT 6 ‚Äî Dashboard Service

Create dashboard.service.ts that calls:
- GET /dashboard/kpis
- GET /dashboard/trends
- GET /dashboard/table

Requirements:
- HttpClient
- RxJS Observables
- No client-side aggregation


‚∏ª

üîπ FRONTEND PROMPT 7 ‚Äî KPI Cards Component

Create KPI cards component.

Requirements:
- @Input() KPI data
- Value + % change
- Status color
- OnPush change detection
- No API calls


‚∏ª

üîπ FRONTEND PROMPT 8 ‚Äî Trend Chart Component

Create trend chart component.

Requirements:
- Uses aggregated trend data
- Range toggle: 7 / 30 / 90 / 365
- Events, Requests, SLA breaches
- Match installed chart library


‚∏ª

üîπ FRONTEND PROMPT 9 ‚Äî SLA Widget

Create SLA compliance widget.

Requirements:
- SLA met vs breached
- Percentage display
- Donut or gauge chart
- @Input() data only


‚∏ª

üîπ FRONTEND PROMPT 10 ‚Äî Breakdown Charts

Create reusable horizontal bar chart component.

Usage:
- Requests by Product
- Requests by Service

Emit click event for filtering.


‚∏ª

üîπ FRONTEND PROMPT 11 ‚Äî Controls Table

Create controls table component.

Requirements:
- Server-side pagination
- Server-side sorting
- Server-side filtering
- Uses /dashboard/table
- trackBy enabled


‚∏ª

üîπ FRONTEND PROMPT 12 ‚Äî Dashboard Composition

Compose dashboard-page.component with layout:

Row 1: KPI cards
Row 2: Trend chart + SLA widget
Row 3: Breakdown charts
Row 4: Controls table

One API call per section.


‚∏ª

üîπ FRONTEND PROMPT 13 ‚Äî Styling (V2 Only)

Create new styling system for app-v2:

src/styles-v2/
- tokens.scss
- layout.scss
- components.scss
- theme.scss

Add styles-v2 to angular.json.


‚∏ª

üîπ FRONTEND PROMPT 14 ‚Äî Performance Check

Review dashboard-v2 and ensure:
- OnPush everywhere
- async pipe usage
- No legacy endpoints used
- No large client-side processing

Return checklist.


‚∏ª

‚úÖ THIS NOW COVERS EVERYTHING

‚úî Backend improvements
‚úî Performance
‚úî Scalability
‚úî Clean UI rebuild
‚úî Safe migration
‚úî No legacy coupling

This is exactly how senior teams do phased rewrites.

If you want, next I can:
	‚Ä¢	Convert this into a Notion / Jira task list
	‚Ä¢	Or compress it into a one-page execution checklist

Just tell me 


Add a new FastAPI endpoint:

GET /dashboard/kpis

Rules:
- Add route in angular/api/main.py
- Use existing Oracle views (do not query base tables)
- Use utils_trans_db.py for DB execution
- Do not modify existing endpoints

Compute server-side using SQL:
- eventsToday (EMAIL_RECEIVEDTIME = today)
- requestsToday (OPERATION='Issue' AND EMAIL_RECEIVEDTIME = today)
- dueToday (SLA_DATE = today)
- dueNext5Days (SLA_DATE between today+1 and today+5)
- undefinedRequests (OPERATION IS NULL OR '')
- slaBreaches (USERSLAFETFLAG = 'N')

Also compute:
- Same KPIs for yesterday
- Same KPIs for last week

Return:
- Route code
- SQL queries
- Pydantic response schema
- Sample JSON response




Add a new FastAPI endpoint:

GET /dashboard/kpis

Rules:
- Add route in angular/api/main.py
- Use get_analyticsdb_data(query) for DB access
- Query ONLY Oracle views (do not query base tables)
- Do not modify or break existing endpoints

Compute server-side using SQL (Oracle):

- eventsToday:
  COUNT(*) where TRUNC(EMAIL_RECEIVEDTIME) = TRUNC(SYSDATE)

- requestsToday:
  COUNT(*) where OPERATION = 'Issue'
  AND TRUNC(EMAIL_RECEIVEDTIME) = TRUNC(SYSDATE)

- dueToday:
  COUNT(*) where TRUNC(SLA_DATE) = TRUNC(SYSDATE)

- dueNext5Days:
  COUNT(*) where SLA_DATE BETWEEN TRUNC(SYSDATE)+1 AND TRUNC(SYSDATE)+5

- undefinedRequests:
  COUNT(*) where OPERATION IS NULL OR OPERATION = ''

- slaBreaches:
  COUNT(*) where USERSLAFETFLAG = 'N'

Also compute the same KPIs for:
- yesterday
- last week

Return:
- FastAPI route code
- Oracle SQL queries
- Pydantic response schema (KPIsResponse)
- Add a new FastAPI endpoint:

GET /dashboard/trends

Rules:
- Add route in angular/api/main.py
- Use get_analyticsdb_data(query)
- Query ONLY Oracle views
- Do not return raw rows

Requirements:
- Aggregate by date
- Support groupBy: daily | weekly | monthly
- Support rangeDays (default 30, max 365)

Return:
- Route code
- Oracle SQL
- Pydantic response schema
- Sample JSON response



step3
Add a new FastAPI endpoint:

GET /dashboard/table

Rules:
- Add route in angular/api/main.py
- Use get_analyticsdb_data(query) for DB access
- Query ONLY Oracle views (do not query base tables)
- Do NOT modify or break existing endpoints
- Do NOT return the full dataset under any condition

Functional Requirements:

1) Pagination
- Params:
  - page (default 1)
  - pageSize (default 25, max 100)
- Use Oracle OFFSET / FETCH NEXT
- Return totalCount using a separate COUNT(*) query

2) Sorting
- Params:
  - sortField (validated against allowed column list)
  - sortDirection (ASC | DESC)
- Prevent SQL injection by whitelisting columns

3) Filtering
- Supported filters:
  - date range (EMAIL_RECEIVEDTIME from/to)
  - OPERATION
  - SERVICE
  - PRODUCT
  - USERSLAFETFLAG
- Filters must apply to BOTH:
  - data query
  - totalCount query

4) Date Handling (IMPORTANT)
- All date comparisons must use TRUNC()
- Date filters must be applied in SQL, not Python
- Never compare dates to expressions incorrectly (avoid TRUNC(date)=TRUNC(other_column))

5) SLA Logic (IMPORTANT)
- SLA breaches must always be date-bounded
- Never count historical SLA breaches unintentionally

6) Null Safety
- Use NVL() for numeric fields
- Ensure no NULL values are returned for counts or flags

SQL Requirements:
- Use SELECT only
- Avoid SELECT *
- Explicit column list
- Reuse existing Oracle views with VPD intact

Response Shape:
{
  "data": [ ... rows ... ],
  "totalCount": number,
  "page": number,
  "pageSize": number
}

Return:
- FastAPI route code
- Oracle SQL for:
  - paginated data
  - totalCount
- Pydantic response schema
- Sample JSON response




UI
step1
Create a new Angular frontend under src/app-v2.

Rules:
- Do not touch src/app (legacy)
- Copy only core/, environments/, assets/
- Create app-v2.module.ts
- Create app-v2-routing.module.ts
- Lazy load dashboard module at /dashboard-v2





